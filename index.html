<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AI Prompt Builder PRO+</title>

<meta name="theme-color" content="#111">

<!-- PWA -->
<link rel="manifest" href="data:application/manifest+json,{
  &quot;name&quot;:&quot;AI Prompt Builder PRO+&quot;,
  &quot;short_name&quot;:&quot;Prompt PRO&quot;,
  &quot;start_url&quot;:&quot;.&quot;,
  &quot;display&quot;:&quot;standalone&quot;,
  &quot;background_color&quot;:&quot;#111&quot;,
  &quot;theme_color&quot;:&quot;#111&quot;
}">

<style>
body{margin:0;font-family:system-ui;background:#f2f2f2}
header{background:#111;color:#fff;padding:12px;font-weight:bold}
.main{display:flex;height:calc(100vh - 48px)}
.left{width:70%;overflow:auto;padding:12px}
.right{width:30%;background:#000;padding:12px;position:sticky;top:0}
.card{background:#fff;border-radius:12px;padding:12px;margin-bottom:12px}
h3{margin:0 0 8px}
textarea,select,input,button{
  width:100%;margin-top:6px;padding:10px;
  border-radius:8px;border:1px solid #ccc;font-size:15px
}
button{border:none;cursor:pointer}
.green{background:#28a745;color:#fff}
.red{background:#dc3545;color:#fff}
.gray{background:#6c757d;color:#fff}
.output{background:#000;color:#0f0;font-family:monospace;height:90%}
.row{display:flex;gap:6px}
hr{border:none;border-top:1px dashed #ccc;margin:12px 0}
</style>
</head>

<body>

<header>üß† AI Prompt Builder PRO+ (Offline)</header>

<div class="main">

<div class="left">

  <div class="card">
    <h3>üì¶ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
    <select id="product"></select>
    <input id="newProduct" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
    <div class="row">
      <button class="green" onclick="addProduct()">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
      <button class="red" onclick="delProduct()">‡∏•‡∏ö</button>
    </div>
  </div>

  <hr>

  <div class="card">
    <h3>üß© ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</h3>
    <select id="job"></select>
    <input id="jobName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô">
    <textarea id="jobTpl" placeholder="‡πÉ‡∏ä‡πâ ${p} ‡πÅ‡∏ó‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"></textarea>
    <div class="row">
      <button class="green" onclick="saveJob()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
      <button class="red" onclick="delJob()">‡∏•‡∏ö</button>
    </div>
  </div>

</div>

<div class="right">
  <h3 style="color:#fff">üìÑ Prompt</h3>
  <textarea id="result" class="output" readonly></textarea>
  <button class="gray" onclick="copy()">üìã Copy</button>
</div>

</div>

<script>
/* ===== Service Worker (INLINE) ===== */
if('serviceWorker' in navigator){
  const sw = `
    self.addEventListener('install',e=>{
      e.waitUntil(caches.open('pwa').then(c=>c.addAll(['./'])))
    })
    self.addEventListener('fetch',e=>{
      e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)))
    })
  `;
  navigator.serviceWorker.register(URL.createObjectURL(
    new Blob([sw],{type:'text/javascript'})
  ));
}

/* ===== App Logic ===== */
const LS_P="p",LS_J="j";
let P=JSON.parse(localStorage.getItem(LS_P))||["‡∏ó‡πá‡∏≠‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå"];
let J=JSON.parse(localStorage.getItem(LS_J))||[
  {n:"UGC Sora",t:"‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏£‡∏µ‡∏ß‡∏¥‡∏ß ${p} ‡πÅ‡∏ö‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡∏£‡∏¥‡∏á"}
];

const $=id=>document.getElementById(id);

function save(){localStorage.setItem(LS_P,JSON.stringify(P));localStorage.setItem(LS_J,JSON.stringify(J))}
function render(){
  product.innerHTML=P.map((v,i)=>`<option value=${i}>${v}</option>`).join("");
  job.innerHTML=J.map((v,i)=>`<option value=${i}>${v.n}</option>`).join("");
  update();
}
function update(){
  if(!P.length||!J.length)return;
  jobName.value=J[job.value].n;
  jobTpl.value=J[job.value].t;
  result.value=J[job.value].t.replaceAll("${p}",P[product.value]);
}

function addProduct(){if(newProduct.value){P.push(newProduct.value);newProduct.value="";save();render()}}
function delProduct(){P.splice(product.value,1);save();render()}
function saveJob(){J[job.value]={n:jobName.value,t:jobTpl.value};save();render()}
function delJob(){J.splice(job.value,1);save();render()}
function copy(){navigator.clipboard.writeText(result.value)}

product.onchange=job.onchange=update;
render();
</script>

</body>
</html>